using Microsoft.EntityFrameworkCore;
using ABCRetailers.Models;

namespace ABCRetailers.Data
{
    public class AuthDbContext : DbContext
    {
        public AuthDbContext(DbContextOptions<AuthDbContext>
    options)
    : base(options)
    {
    }

    public DbSet<User>
        Users { get; set; }
        public DbSet<Cart>
            Carts { get; set; }

            protected override void OnModelCreating(ModelBuilder modelBuilder)
            {
            base.OnModelCreating(modelBuilder);

            // Configure User entity
            modelBuilder.Entity<User>
                (entity =>
                {
                entity.ToTable("Users");
                entity.HasIndex(e => e.Username).IsUnique();
                entity.HasIndex(e => e.Email).IsUnique();
                });

                // Configure Cart entity
                modelBuilder.Entity<Cart>
                    (entity =>
                    {
                    entity.ToTable("Carts");
                    entity.HasOne(c => c.User)
                    .WithMany()
                    .HasForeignKey(c => c.UserId)
                    .OnDelete(DeleteBehavior.Cascade);
                    });
                    }
                    }
                    }

